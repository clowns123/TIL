# 1. 리액트 자세히 알기

## 1.1 리액트 탄생 비화

**브라우저 작동**

1) **그림 파일 전달:** 해당 도메인에 접속을 하면, 서버 사이드에서 그림 파일(HTML,CSS,JS)를 순차적으로 프론트단으로 전달을 해주고 2) **DOM 트리 생성:** 브라우저가 HTM을 먼저 전달 받게 되면, 브라우저의 렌더(화면을 그리는) 엔진이 이를 파싱(해석)하고 DOM 노드로 이루어진 일종의 계층 구조 격의 트리를 만듭니다. 그래서 간혹 HTML을 공부할 때, DOM 트리 또는 DOM 노드라는 말을 접하게 되는데, 화면을 구성하는 HTML 태그간의 계층 구조를 생성! 하는 뜻이라고 생각하시면 좋습니다.

3) **CSS 파싱:**  이렇게 DOM 트리가 구성이 되면 CSS 파일과 각 엘리먼트(태그)의 인라인 스타일도 파싱하게 됩니다. 이러한 스타일 정보를 바탕으로 DOM 트리에 따라 새로운 트리를 다시한번 구성하게 됩니다.  

4) **Render 트리 생성:** 각 DOM 트리의 모든 노드들을 attach라는 메소드를 가지고 있는데, 이 메소드는 스타일 정보를 계산해서 객체형태로 반환합니다. 말은 어렵지만, 이제 화면에 그리기를 준비하는 과정입니다.

5) **Layout 구성:** Render 트리까지 구성이 완료되면, 이제 레이아웃 과정을 거칩니다. 각 노드들은 스크린 좌표가 주어지고 정확히 어디에 나타내야 할 지 위치를 잡습니다.

6) **Painting:** 이제 준비가 끝났으면 그려야죠! 렌더링된 요소들에 색을 입히고, 트리의 각 노드들을 거치면서 painting() 함수를 호출 합니다. 그러고 나면, 화면 구성이 완료됩니다. 



이렇게 DOM을 조작한다는 것은, 여러 과정들이 반복된다는 것을 의미합니다. 그렇기에 DOM 조작이 많이 발생하고 복잡한 SPA(싱글 페이지 어플리케이션)에서는 이런 비효율적인 과정에 대해 고민 할 필요가 있었습니다.

히스토리적으로 Jquery는 이 DOM을 조작하는데 오랫동안 왕으로 군림했습니다. $.() 을 통해서 쉽게 DOM을 조작할 수 있었으며 비동기적인 처리면에서도 정말 획기적이였습니다. 

그러다가 그 이름도 유명한 Backbone, AngularJS와 같은 프론트엔드 프레임워크가 등장했죠. 그러나 역시 Jquery가 몰락한 것은 아니여서 이 둘 프레임워크에서도 Jquery로 DOM을 다루는 중요한 방법으로 사용했습니다. 다 구조화된 프론트엔드 환경을 똑똑한 개발자들이 제시하기 시작했습니다. 



그러나 DOM 조작의 문제는 해결되지 않았습니다. 

DOM 조작의 실제 문제는 각 조작이 레이아웃 변화, 트리 변화와 렌더링을 일으킨다는 겁니다. 그래서, 예를 들어 여러분이 30개의 노드를 하나 하나 수정하면, 그 뜻은 30번의 (잠재적인) 레이아웃 재 계산과 30번의 (잠재적인) 리렌더링을 초래한다는 것이죠.

이 문제를 좀 더 확실히 해결하고자 나온게 ReactJS입니다.

---

**Virtual DOM**

![img](https://glenncy.s3.ap-northeast-2.amazonaws.com/lecture/reactjs/2%20ReactJS/Untitled%205.png)



바뀐 부분을 Virtual DOM에 적용한 다음 Real DOM과 비교해서 바뀐 부분만 Real DOM에 적용시킨다.

**1. 데이터가 업데이트되어 DOM 조작이 불가피 할 때, 전체 UI 를 Virtual DOM 에 리렌더링 합니다.**

**2. 이전 Virtual DOM 에 있던 내용과 현재의 DOM 내용을 비교합니다.**

**3. 바뀐 부분만 실제 DOM 에 적용이 됩니다.**

결국에는 컴포넌트가 업데이트 될 때, 레이아웃 계산이 **한번**만 이뤄집니다.

> 비트코인 사이트나 주식 사이트 등 실시간으로 데이터가 변화하는 사이트를 만들어보자



단 React를 쓴다고 무조건 빨라지는건 아니다. 리엑트 공식문서에 가보면 이런 말이 있습니다.

**지속해서 데이터가 변화하는 대규모 애플리케이션 구축 문제를 위해 React를 만들었다**

---

**리액트의 특징**

## 단방향 데이터 바인딩 

**"one-way reactive data flow"**

**데이터는 Parent로부터 Child로 흐르며, 데이터의 갱신에 반응하여 뷰 또한 갱신**

React는 기타 javascript framework와 다르게 데이터 흐름이 단방향으로 이루어져 있습니다.

Angular js 및 Backbone을 살펴보면, Data의 변경을 framework에서 감지하고 있다가, 변경되는 시점에 DOM 객체에 렌더링 해주거나, 페이지 내에서의 모델의 변경을 감지하여 javascript 실행부에서 변경하는 등의 **"양방향 데이터 바인딩"**을 가지고 있습니다. 

양방향 데이터 바인딩은 코드의 사용면에서 코드량을 크게 줄여주는 등의 장점이 있을 수 있겠지만, 자체 실행 코드 내에서 데이터의 변화를 감지하여 DOM 객체 전체를 렌더링 해주거나, 데이터를 바꿔주는 등의 실행으로 인하여 성능이 감소되는 경우가 생깁니다.(ionic을 사용해 보시면 성능에 관련된 부분이 좀더 민감하게 다가오실 수도 있습니다.)

React는 이러한 양방향 바인딩이 아니기 때문에 실행부 자체 내에서 데이터의 변화를 감지하지 않으며, 데이터에 변화가 오게 되면, 특정 함수를 실행시킴으로써 DOM 객체를 갱신합니다. 따라서, 성능에 관련되어 데이터 변화에 따른 성능 저하 없이 DOM 객체를 갱신해 줄 수 있는 장점이 있습니다.



![img](https://glenncy.s3.ap-northeast-2.amazonaws.com/lecture/reactjs/2%20ReactJS/Untitled%206.png)

![img](https://glenncy.s3.ap-northeast-2.amazonaws.com/lecture/reactjs/2%20ReactJS/Untitled%207.png)

이렇게 컴포넌트(Component)는 UI를 구성하는 개별적인 뷰 단위라 볼 수 있고, 마치 레고 블럭을 쌓는 것 처럼 조립해서 하나의 페이지를 구성하는 방식입니다. 이렇게 필요한 부분 부분을 구성하면 어떤 점이 좋을까요? 

컴포넌트를 사용하는 이유는

- 현대의 웹은 크고 복잡하다.
- 복잡한 문제(개발할 시스템)를 작게 나누어서 해결하기 위해 필요하다.
- 컴포넌트 단위로 코드를 작성하면 캡슐화(테스트 가용성, 신뢰성), 확장성, 결합성, 재사용성 같은 이점이 있다.



## JSX



JSX는 React를 위해 태어난 새로운 자바스크립트 문법으로, 과거 페이스북이 만들었던 PHP의 개량판 XHP에 그 기원을 두고 있습니다.



```react
class HelloWorld extends React.Component {
  render() {
    return <div>안녕! {this.props.name}</div>;
  }
}
ReactDOM.render(<HelloWorld name="건희야" />, mountNode)
```

React는 작성한 코드를 컴파일하는 과정을 꼭 거쳐야 합니다. 대부분 사실상 자바스크립트 표준이 되어가고 있는 Babel을 사용하죠. Babel의 React 플러그인을 통해 위의 코드를 컴파일하면 다음과 같은 모습이 됩니다.

```js
class HelloWorld extends React.Component {
  render() {
    return React.createElement(
      "div",
      null,
      "안녕! ",
      this.props.name
    );
  }
}

ReactDOM.render(React.createElement(HelloWorld, { name: "건희야" }), mountNode);
```

즉 React를 사용할려면  Babel과 같은 트랜스파일러를 꼭 써야 하기 때문에 추후에 웹팩 설정이 필수적입니다.

**정리하자면!** 

1. JSX는 함수 호출과 객체 생성을 위한 문법적 편의를 제공하는 자바스크립트의 확장으로, 특히 React.createElement() 호출을 반복해야 하는 불편을 해소해 줍니다. 

2. 템플릿 엔진이나 HTML처럼 보일 수도 있지만 그렇지 않습니다. JSX는 React 엘리먼트를 생성하면서 자바스크립트의 모든 기능을 쓸 수 있도록 도와준다.

3. JSX는 React 컴포넌트를 생성하는 좋은 방법입니다. JSX의 장점을 정리해보면 다음과 같습니다.



**• 개발자 경험(developer experience, DX) 개선: 표현력이 뛰어나 코드를 읽기 쉽다. XML과 문법이 유사하여 중첩된 선언형 구조를 더 잘 나타낸다.**

**• 팀의 생산성 향상: 전문 개발자 외에도 개발 지식이 있는 팀원이 있다면 직접 코드를 수정할 수도 있다. JSX는 HTML과 비슷하여 이들에게도 친숙하기 때문이다.**

**• 문법 오류와 코드량 감소: 작성해야 할 코드가 줄어들며, 이는 곧 실수나 반복으로 인한 스트레스를 줄여준다.**



# React CDN 방식

리액트는 프로젝트 전체에 적용할 수 있지만 특정 페이지에 리액트를 끼워넣어서 JQuery처럼 사용이 가능하다.

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <div id="root"></div>
    <script crossorigin src="https://unpkg.com/react@16/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
    <script>
        //Greeting Component 생성
        class Greeting extends React.Component {
            render() {
                return React.createElement(
                    "div",
                    null,
                    "Hello world"
                );
            }
        }

        //Greeting Component 주입
        ReactDOM.render(React.createElement(Greeting),  document.getElementById('root'));
        </script>
</body>
</html>
```

지금은 JSX가 아닌 순수 자바스크립트로 React를 사용한 것이다. 이를 JSX로 작동을 확인해보자

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>차근차근 배우는 ReactJS</title>
</head>
<body>
        <div id="root"></div>
        <script crossorigin src="https://unpkg.com/react@16/umd/react.development.js"></script>
        <script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/6.21.1/babel.min.js"></script>
        
        <script type="text/babel">
        class Greeting extends React.Component {
            render() {
                return (<p>Hello world</p>);
            }
        }
        ReactDOM.render(
            <Greeting />,
            document.getElementById('root')
        );
        </script>
</body>
</html>
```

render부분을 보면 순수 js보다는 JSX가 보기가 쉽고 코드 분량도 적다.

하지만 실제 CDN방식으로 개발하는 경우는 별로 없다. 실제 개발을 시작해보자.